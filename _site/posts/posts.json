[
  {
    "path": "posts/2021-09-11-adara-challenge-analysis/",
    "title": "Adara Challenge Analysis",
    "description": "Technical Analytical Assessment for Field Data Science team",
    "author": [
      {
        "name": "Archie Dolit",
        "url": "https://www.linkedin.com/in/adolit/"
      }
    ],
    "date": "2021-09-11",
    "categories": [
      "R",
      "Adara",
      "Analytical Assessment"
    ],
    "contents": "\r\n\r\nContents\r\n1. Executive Summary\r\n2. Methodology\r\n2.1 Data Dictionary\r\n2.1 Exploratory Data Analysis\r\n2.2 Data Preparation\r\n2.3 Data Visualisation\r\n\r\n3. Derived Insights\r\n4. Recommendations\r\n\r\n1. Executive Summary\r\nDistill is a publication format for scientific and technical writing, native to the web.\r\n2. Methodology\r\n2.1 Data Dictionary\r\nThe data contains events from the months of January 2019 and January 2021; the 2019 can be used as a basis of comparison for the activity in 2021.\r\nThe destinations contained in the data are selected top-tier cities in Germany, UK, France, Italy, and Spain\r\nThe table below shows the definition of attributes:\r\nAttributes\r\nDefinition\r\nevent_date\r\nThe date of the search or booking activity. This is different from the departure_checkin_date, which is the actual date of travel activity: if a customer makes a booking today for check-in on 1 October, today’s date would be the event date, and 1 October would be the “departure_checkin_date”\r\nactivity_group\r\nAn indicator of the type of event on the hotel website. Classified as “Searching” (a general search for a room) or “Booking” (an actual reservation)\r\nreason_for_travel_detailed\r\nthis is the Reason for Travel, categorized as either “Business”, “Leisure-Non-Family” (leisure travel consisting of 1 or 2 people), and “Leisure-Family” (leisure travel consisting of 3 or more people)\r\norigin_country_code\r\n2-letter ISO country code indicating the origin country from which the booking or search activity was made\r\nhotel_city,hotel_state,hotel_country\r\nraw information specifying the destination in question. Note that this data is in an unclean state, provided straight from the source system.\r\ntraveler_value_group\r\nIndicator of traveler value (overall spend + loyalty status), grouped into “Low”, “Medium”, “High”\r\ndeparture_checkin_date\r\nStart date of hotel stay; see event_date to determine how the date information differs.\r\ntotal_number_events\r\nAggregated count of total number of events\r\n2.1 Exploratory Data Analysis\r\nInstall and Launch R Packages\r\n\r\n\r\nhide\r\n\r\npackages = c('ggiraph',\r\n             'plotly', \r\n             'lubridate',\r\n             'clock',\r\n             'DT',\r\n             'vtable',\r\n             'tidyverse')\r\n\r\nfor(p in packages){\r\n  if(!require(p, character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p, character.only = T)\r\n}\r\n\r\n\r\n\r\nImport Data\r\n\r\n\r\nhide\r\n\r\nraw_data <- read_csv(\"data/sample_data.csv\")\r\nglimpse(raw_data)\r\n\r\n\r\nRows: 724,795\r\nColumns: 10\r\n$ event_date                 <date> 2019-01-07, 2019-01-16, 2021-01-~\r\n$ activity_group             <chr> \"Booking\", \"Searching\", \"Searchin~\r\n$ reason_for_travel_detailed <chr> \"Leisure - Non-Family\", \"Business~\r\n$ origin_country_code        <chr> \"DE\", \"GB\", \"DE\", \"US\", \"DE\", \"DE~\r\n$ hotel_city                 <chr> \"dusseldorf\", \"dusseldorf\", \"duss~\r\n$ hotel_state                <chr> NA, NA, NA, NA, NA, NA, NA, NA, N~\r\n$ hotel_country              <chr> \"de\", \"de\", \"de\", \"de\", \"de\", \"de~\r\n$ traveler_value_group       <chr> \"Med\", \"Med\", \"Low\", \"Low\", \"Low\"~\r\n$ departure_checkin_date     <date> 2019-01-25, 2019-02-05, 2021-01-~\r\n$ total_number_events        <dbl> 1, 1, 1, 2, 2, 1, 1, 1, 3, 1, 1, ~\r\n\r\nSummary Statistics\r\n\r\n\r\nhide\r\n\r\nst(raw_data)\r\n\r\n\r\n\r\n(#tab:summary 2 csv)Summary Statistics\r\n\r\n\r\nVariable\r\n\r\n\r\nN\r\n\r\n\r\nMean\r\n\r\n\r\nStd. Dev.\r\n\r\n\r\nMin\r\n\r\n\r\nPctl. 25\r\n\r\n\r\nPctl. 75\r\n\r\n\r\nMax\r\n\r\n\r\nactivity_group\r\n\r\n\r\n724795\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… Booking\r\n\r\n\r\n89118\r\n\r\n\r\n12.3%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… Searching\r\n\r\n\r\n635677\r\n\r\n\r\n87.7%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nreason_for_travel_detailed\r\n\r\n\r\n724795\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… Business\r\n\r\n\r\n313401\r\n\r\n\r\n43.2%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… Leisure - Family\r\n\r\n\r\n58859\r\n\r\n\r\n8.1%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… Leisure - Non-Family\r\n\r\n\r\n352535\r\n\r\n\r\n48.6%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\ntraveler_value_group\r\n\r\n\r\n724795\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… High\r\n\r\n\r\n96496\r\n\r\n\r\n13.3%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… Low\r\n\r\n\r\n382542\r\n\r\n\r\n52.8%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… Med\r\n\r\n\r\n245172\r\n\r\n\r\n33.8%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n… None\r\n\r\n\r\n585\r\n\r\n\r\n0.1%\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\ntotal_number_events\r\n\r\n\r\n724795\r\n\r\n\r\n2.295\r\n\r\n\r\n4.651\r\n\r\n\r\n1\r\n\r\n\r\n1\r\n\r\n\r\n2\r\n\r\n\r\n390\r\n\r\n\r\nMutate Date and Traver Value Group\r\n\r\n\r\nhide\r\n\r\nraw_data$event_wday <- wday(raw_data$event_date,\r\n                          label = TRUE,\r\n                          abbr = TRUE)\r\n\r\nraw_data$event_year <- factor(year(raw_data$event_date))\r\n\r\nraw_data$event_mday <- factor(paste(month(raw_data$event_date,\r\n                             label = TRUE,\r\n                             abbr = TRUE),\r\n                             str_pad(mday(raw_data$event_date),2,side=\"left\", pad=0),\r\n                             sep = \" \"))\r\n\r\nraw_data$checkin_wday <- factor(wday(raw_data$departure_checkin_date,\r\n                          label = TRUE,\r\n                          abbr = TRUE))\r\n\r\nraw_data$checkin_year <- factor(year(raw_data$departure_checkin_date))\r\n\r\nraw_data$checkin_month <- factor(month(raw_data$departure_checkin_date,\r\n                             label = TRUE,\r\n                             abbr = TRUE))\r\n\r\nraw_data$traveler_value_group <- factor(raw_data$traveler_value_group, order = TRUE,\r\n                                        levels = c(\"Low\", \"Med\", \"High\"))\r\n\r\nglimpse(raw_data)\r\n\r\n\r\nRows: 724,795\r\nColumns: 16\r\n$ event_date                 <date> 2019-01-07, 2019-01-16, 2021-01-~\r\n$ activity_group             <chr> \"Booking\", \"Searching\", \"Searchin~\r\n$ reason_for_travel_detailed <chr> \"Leisure - Non-Family\", \"Business~\r\n$ origin_country_code        <chr> \"DE\", \"GB\", \"DE\", \"US\", \"DE\", \"DE~\r\n$ hotel_city                 <chr> \"dusseldorf\", \"dusseldorf\", \"duss~\r\n$ hotel_state                <chr> NA, NA, NA, NA, NA, NA, NA, NA, N~\r\n$ hotel_country              <chr> \"de\", \"de\", \"de\", \"de\", \"de\", \"de~\r\n$ traveler_value_group       <ord> Med, Med, Low, Low, Low, Low, Hig~\r\n$ departure_checkin_date     <date> 2019-01-25, 2019-02-05, 2021-01-~\r\n$ total_number_events        <dbl> 1, 1, 1, 2, 2, 1, 1, 1, 3, 1, 1, ~\r\n$ event_wday                 <ord> Mon, Wed, Thu, Thu, Thu, Sun, Thu~\r\n$ event_year                 <fct> 2019, 2019, 2021, 2021, 2019, 202~\r\n$ event_mday                 <fct> Jan 07, Jan 16, Jan 28, Jan 28, J~\r\n$ checkin_wday               <ord> Fri, Tue, Fri, Sun, Thu, Fri, Mon~\r\n$ checkin_year               <fct> 2019, 2019, 2021, 2021, 2019, 202~\r\n$ checkin_month              <ord> Jan, Feb, Jan, Jul, Jan, Mar, Mar~\r\n\r\nEvent Year EDA\r\n\r\n\r\nhide\r\n\r\ncolor_2019 <- \"darkgray\"\r\ncolor_2021 <- \"purple\"\r\ncolor_bg <- \"snow\"\r\n\r\n# event_year_cnt <- raw_data %>%\r\n#   count(event_year) %>%\r\n#   plot_ly(x=~event_year,\r\n#           y=~n,\r\n#           type= 'bar',\r\n#           marker = list(color = color_2021),\r\n#           hovertemplate = paste('Event Year: %{x}<br>',\r\n#                                 'Count: %{y}',\r\n#                                 '<extra><\/extra>')) %>%\r\n#   layout(xaxis = list(title = \"\"),\r\n#          yaxis = list(title = \"Total Number of Events\"),\r\n#          hoverlabel=list(bgcolor=color_bg))\r\n#event_year_cnt\r\n\r\nevent_year_data <- raw_data %>%\r\n  group_by(event_year) %>%\r\n  summarise(event_year_sum = sum(total_number_events))\r\n\r\nevent_year_total <- event_year_data %>%\r\n  plot_ly(x=~event_year,\r\n          y=~event_year_sum,\r\n          type= 'bar',\r\n          marker = list(color = c(color_2019,color_2021)),\r\n          hovertemplate = paste('Event Year: %{x}<br>',\r\n                                'Total Number of Events: %{y}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Event Year EDA\",\r\n         xaxis = list(title = \"\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nevent_year_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b4fc64562\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b4fc64562\",\"attrs\":{\"15b4fc64562\":{\"x\":{},\"y\":{},\"marker\":{\"color\":[\"darkgray\",\"purple\"]},\"hovertemplate\":\"Event Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Event Year EDA\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"2019\",\"2021\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"2019\",\"2021\"],\"y\":[1286103,377380],\"marker\":{\"color\":[\"darkgray\",\"purple\"],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Event Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\nevent_year_data$pct_total <- prop.table(event_year_data$event_year_sum) \r\n\r\nDT::datatable(data = event_year_data,\r\n              options = list(pageLength = 2),\r\n              colnames = c(\"Event Year\", \"Total Number of Events\", \"Percent of Total\"),\r\n              rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('event_year_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"2019\",\"2021\"],[1286103,377380],[0.773138649448176,0.226861350551824]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Event Year<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":2,\"columnDefs\":[{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2]}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[2,10,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nEvent Month Day EDA\r\n\r\n\r\nhide\r\n\r\nevent_mday_2019 <- raw_data %>%\r\n  filter(event_year == 2019) %>%\r\n  group_by(event_mday) %>%\r\n  summarise(mday_2019_sum = sum(total_number_events)) %>%\r\n  arrange(event_mday)\r\n\r\nevent_mday_2021 <- raw_data %>%\r\n  filter(event_year == 2021) %>%\r\n  group_by(event_mday) %>%\r\n  summarise(mday_2021_sum = sum(total_number_events)) %>%\r\n  arrange(event_mday)\r\n\r\nevent_mday_data <- left_join(event_mday_2019,event_mday_2021)\r\n  \r\nevent_mday_total <- event_mday_data %>%\r\n  plot_ly(x=~event_mday,\r\n          y=~mday_2019_sum ,\r\n          type = 'scatter',\r\n          mode = 'lines+markers',\r\n          line = list(color = color_2019),\r\n          marker = list(color = color_2019),\r\n          name = '2019',\r\n          hovertemplate = paste('Event Month Day: %{x}, 2019<br>',\r\n                                'Total Number of Events: %{y}',\r\n                                '<extra><\/extra>')) %>%\r\n  add_trace(y =~mday_2021_sum,\r\n            mode = 'lines+markers',\r\n            line = list(color = color_2021),\r\n            marker = list(color = color_2021),\r\n            name = '2021',\r\n            hovertemplate = paste('Event Month Day: %{x}, 2021<br>',\r\n                                  'Total Number of Events: %{y}',\r\n                                  '<extra><\/extra>')) %>%\r\n  layout(title = \"Event Month Day EDA\",\r\n         xaxis = list(title = \"\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nevent_mday_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b4505f2be8\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b4505f2be8\",\"attrs\":{\"15b4505f2be8\":{\"x\":{},\"y\":{},\"mode\":\"lines+markers\",\"line\":{\"color\":\"darkgray\"},\"marker\":{\"color\":\"darkgray\"},\"hovertemplate\":\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"name\":\"2019\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\"},\"15b4505f2be8.1\":{\"x\":{},\"y\":{},\"mode\":\"lines+markers\",\"line\":{\"color\":\"purple\"},\"marker\":{\"color\":\"purple\"},\"hovertemplate\":\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"name\":\"2021\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Event Month Day EDA\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Jan 01\",\"Jan 02\",\"Jan 03\",\"Jan 04\",\"Jan 05\",\"Jan 06\",\"Jan 07\",\"Jan 08\",\"Jan 09\",\"Jan 10\",\"Jan 11\",\"Jan 12\",\"Jan 13\",\"Jan 14\",\"Jan 15\",\"Jan 16\",\"Jan 17\",\"Jan 18\",\"Jan 19\",\"Jan 20\",\"Jan 21\",\"Jan 22\",\"Jan 23\",\"Jan 24\",\"Jan 25\",\"Jan 26\",\"Jan 27\",\"Jan 28\",\"Jan 29\",\"Jan 30\",\"Jan 31\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Jan 01\",\"Jan 02\",\"Jan 03\",\"Jan 04\",\"Jan 05\",\"Jan 06\",\"Jan 07\",\"Jan 08\",\"Jan 09\",\"Jan 10\",\"Jan 11\",\"Jan 12\",\"Jan 13\",\"Jan 14\",\"Jan 15\",\"Jan 16\",\"Jan 17\",\"Jan 18\",\"Jan 19\",\"Jan 20\",\"Jan 21\",\"Jan 22\",\"Jan 23\",\"Jan 24\",\"Jan 25\",\"Jan 26\",\"Jan 27\",\"Jan 28\",\"Jan 29\",\"Jan 30\",\"Jan 31\"],\"y\":[27776,43622,42977,42224,31313,36352,49382,48153,48973,51038,41952,29948,38274,48069,47432,46279,42202,39085,29315,37607,46718,43314,44166,40907,36541,32708,38726,47030,47009,45365,41646],\"mode\":\"lines+markers\",\"line\":{\"color\":\"darkgray\"},\"marker\":{\"color\":\"darkgray\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2019<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"name\":\"2019\",\"type\":\"scatter\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Jan 01\",\"Jan 02\",\"Jan 03\",\"Jan 04\",\"Jan 05\",\"Jan 06\",\"Jan 07\",\"Jan 08\",\"Jan 09\",\"Jan 10\",\"Jan 11\",\"Jan 12\",\"Jan 13\",\"Jan 14\",\"Jan 15\",\"Jan 16\",\"Jan 17\",\"Jan 18\",\"Jan 19\",\"Jan 20\",\"Jan 21\",\"Jan 22\",\"Jan 23\",\"Jan 24\",\"Jan 25\",\"Jan 26\",\"Jan 27\",\"Jan 28\",\"Jan 29\",\"Jan 30\",\"Jan 31\"],\"y\":[10260,10967,12257,14650,14234,12297,13085,12105,10223,9526,13427,13443,13578,13572,13143,10092,10093,12116,12454,12914,12771,12536,11341,10315,13620,13201,12742,12854,12012,10428,11124],\"mode\":\"lines+markers\",\"line\":{\"color\":\"purple\"},\"marker\":{\"color\":\"purple\",\"line\":{\"color\":\"rgba(255,127,14,1)\"}},\"hovertemplate\":[\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Month Day: %{x}, 2021<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"name\":\"2021\",\"type\":\"scatter\",\"error_y\":{\"color\":\"rgba(255,127,14,1)\"},\"error_x\":{\"color\":\"rgba(255,127,14,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\nevent_mday_data$diff_val <- event_mday_data$mday_2021_sum - event_mday_data$mday_2019_sum\r\nevent_mday_data$diff_pct <- event_mday_data$diff_val/event_mday_data$mday_2019_sum\r\n\r\nDT::datatable(data = event_mday_data,\r\n              options = list(pageLength = 31),\r\n              colnames = c(\"Event Day of Month\", \"2019 Total Events\", \"2021 Total Events\", \"Difference (Values)\" ,\"Difference (%)\"),\r\n              rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('mday_2019_sum', digits = 0) %>%\r\n  formatRound('mday_2021_sum', digits = 0) %>%\r\n  formatRound('diff_val', digits = 0) %>%\r\n  formatPercentage('diff_pct', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"Jan 01\",\"Jan 02\",\"Jan 03\",\"Jan 04\",\"Jan 05\",\"Jan 06\",\"Jan 07\",\"Jan 08\",\"Jan 09\",\"Jan 10\",\"Jan 11\",\"Jan 12\",\"Jan 13\",\"Jan 14\",\"Jan 15\",\"Jan 16\",\"Jan 17\",\"Jan 18\",\"Jan 19\",\"Jan 20\",\"Jan 21\",\"Jan 22\",\"Jan 23\",\"Jan 24\",\"Jan 25\",\"Jan 26\",\"Jan 27\",\"Jan 28\",\"Jan 29\",\"Jan 30\",\"Jan 31\"],[27776,43622,42977,42224,31313,36352,49382,48153,48973,51038,41952,29948,38274,48069,47432,46279,42202,39085,29315,37607,46718,43314,44166,40907,36541,32708,38726,47030,47009,45365,41646],[10260,10967,12257,14650,14234,12297,13085,12105,10223,9526,13427,13443,13578,13572,13143,10092,10093,12116,12454,12914,12771,12536,11341,10315,13620,13201,12742,12854,12012,10428,11124],[-17516,-32655,-30720,-27574,-17079,-24055,-36297,-36048,-38750,-41512,-28525,-16505,-24696,-34497,-34289,-36187,-32109,-26969,-16861,-24693,-33947,-30778,-32825,-30592,-22921,-19507,-25984,-34176,-34997,-34937,-30522],[-0.630616359447005,-0.748590160927972,-0.714800940037695,-0.653040924592649,-0.545428416312714,-0.661724251760563,-0.735024907861164,-0.748613793533113,-0.791252322708431,-0.813354755280379,-0.679943745232647,-0.551121944704154,-0.645242200971939,-0.717655869687324,-0.722908584921572,-0.781931329544718,-0.760840718449363,-0.690008954842011,-0.575166297117517,-0.656606482835642,-0.726636414230061,-0.710578565821674,-0.743218765566273,-0.747842667514117,-0.627268000328398,-0.596398434633729,-0.67097040747818,-0.726685094620455,-0.744474462336999,-0.770131158382013,-0.732891514191039]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Event Day of Month<\\/th>\\n      <th>2019 Total Events<\\/th>\\n      <th>2021 Total Events<\\/th>\\n      <th>Difference (Values)<\\/th>\\n      <th>Difference (%)<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":31,\"columnDefs\":[{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2,3,4]}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,25,31,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\"],\"jsHooks\":[]}\r\nEvent Weekday EDA\r\n\r\n\r\nhide\r\n\r\nevent_wday_2019 <- raw_data %>%\r\n  filter(event_year == 2019) %>%\r\n  group_by(event_wday) %>%\r\n  summarise(wday_2019_sum = sum(total_number_events))\r\n\r\nevent_wday_2021 <- raw_data %>%\r\n  filter(event_year == 2021) %>%\r\n  group_by(event_wday) %>%\r\n  summarise(wday_2021_sum = sum(total_number_events))\r\n\r\nevent_wday_data <- left_join(event_wday_2019,event_wday_2021)\r\n  \r\nevent_wday_total <- event_wday_data %>%\r\n  plot_ly(x=~event_wday,\r\n          y=~wday_2019_sum ,\r\n          type= 'bar',\r\n          marker = list(color = color_2019),\r\n          name = '2019',\r\n          hovertemplate = paste('Event Week Day: %{x} 2019<br>',\r\n                                'Total Number of Events: %{y}',\r\n                                '<extra><\/extra>')) %>%\r\n  add_trace(y =~wday_2021_sum,\r\n            marker = list(color = color_2021),\r\n            name = '2021',\r\n            hovertemplate = paste('Event Week Day: %{x} 2021<br>',\r\n                                  'Total Number of Events: %{y}',\r\n                                  '<extra><\/extra>')) %>%\r\n  layout(title = \"Event Weekday EDA\",\r\n         xaxis = list(title = \"\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nevent_wday_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b41e635064\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b41e635064\",\"attrs\":{\"15b41e635064\":{\"x\":{},\"y\":{},\"marker\":{\"color\":\"darkgray\"},\"hovertemplate\":\"Event Week Day: %{x} 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"name\":\"2019\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"},\"15b41e635064.1\":{\"x\":{},\"y\":{},\"marker\":{\"color\":\"purple\"},\"hovertemplate\":\"Event Week Day: %{x} 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"name\":\"2021\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Event Weekday EDA\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"y\":[150959,191199,213684,228405,218770,159802,123284],\"marker\":{\"color\":\"darkgray\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Event Week Day: %{x} 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2019<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2019<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"name\":\"2019\",\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],\"y\":[53315,53813,53332,51531,52282,60056,53051],\"marker\":{\"color\":\"purple\",\"line\":{\"color\":\"rgba(255,127,14,1)\"}},\"hovertemplate\":[\"Event Week Day: %{x} 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2021<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Event Week Day: %{x} 2021<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"name\":\"2021\",\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(255,127,14,1)\"},\"error_x\":{\"color\":\"rgba(255,127,14,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\nevent_wday_data$diff <- event_wday_data$wday_2021_sum - event_wday_data$wday_2019_sum\r\nevent_wday_data$pct_diff <- event_wday_data$diff/event_wday_data$wday_2019_sum\r\n\r\nDT::datatable(data = event_wday_data,\r\n              options = list(pageLength = 7),\r\n              colnames = c(\"Event Weekday\", \"2019 Total Events\", \"2021 Total Events\", \"Difference (Values)\" ,\"Difference (%)\"),\r\n              rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('wday_2019_sum', digits = 0) %>%\r\n  formatRound('wday_2021_sum', digits = 0) %>%\r\n  formatRound('diff', digits = 0) %>%\r\n  formatPercentage('pct_diff', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],[150959,191199,213684,228405,218770,159802,123284],[53315,53813,53332,51531,52282,60056,53051],[-97644,-137386,-160352,-176874,-166488,-99746,-70233],[-0.646824634503408,-0.718549783210163,-0.750416502873402,-0.774387600971958,-0.761018421172921,-0.624184928849451,-0.569684630609]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Event Weekday<\\/th>\\n      <th>2019 Total Events<\\/th>\\n      <th>2021 Total Events<\\/th>\\n      <th>Difference (Values)<\\/th>\\n      <th>Difference (%)<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":7,\"columnDefs\":[{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2,3,4]}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[7,10,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\"],\"jsHooks\":[]}\r\nActivity Group EDA\r\n\r\n\r\nhide\r\n\r\ncolor_book   <- \"purple\"\r\ncolor_search <- \"darkgray\"\r\n\r\nactivity_data <- raw_data %>%\r\n  group_by(activity_group) %>%\r\n  summarise(activity_sum = sum(total_number_events))\r\n\r\nactivity_total <- activity_data %>%\r\n  plot_ly(x=~activity_group,\r\n          y=~activity_sum,\r\n          type= 'bar',\r\n          marker = list(color = c(color_book,color_search)),\r\n          hovertemplate = paste('Activity Group: %{x}<br>',\r\n                                'Total Number of Events: %{y}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Activity Group EDA\",\r\n         xaxis = list(title = \"\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nactivity_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b4249a6eab\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b4249a6eab\",\"attrs\":{\"15b4249a6eab\":{\"x\":{},\"y\":{},\"marker\":{\"color\":[\"purple\",\"darkgray\"]},\"hovertemplate\":\"Activity Group: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Activity Group EDA\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Booking\",\"Searching\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Booking\",\"Searching\"],\"y\":[128595,1534888],\"marker\":{\"color\":[\"purple\",\"darkgray\"],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Activity Group: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Activity Group: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\nactivity_data$pct_total <- prop.table(activity_data$activity_sum) \r\n\r\nDT::datatable(data = activity_data,\r\n              options = list(pageLength = 2),\r\n              colnames = c(\"Activity Group\", \"Total Number of Events\", \"Percent of Total\"),\r\n              rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('activity_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"Booking\",\"Searching\"],[128595,1534888],[0.0773046673756209,0.922695332624379]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Activity Group<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":2,\"columnDefs\":[{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2]}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[2,10,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nReason for Travel Detailed EDA\r\n\r\n\r\nhide\r\n\r\ncolor_biz <- \"orchid\" #business\r\ncolor_lfam <- \"darkorchid\"  #leisure-family\r\ncolor_lnf  <- \"purple\"  #leisure-non-family\r\n\r\nreason_travel_data <- raw_data %>%\r\n  group_by(reason_for_travel_detailed) %>%\r\n  summarise(reason_travel_sum = sum(total_number_events)) %>%\r\n  arrange(desc(reason_travel_sum))\r\n\r\nactivity_total <- reason_travel_data %>%\r\n  plot_ly(x=~reorder(reason_for_travel_detailed,desc(reason_travel_sum)),\r\n          y=~reason_travel_sum,\r\n          type= 'bar',\r\n          marker = list(color = c(color_biz,color_lfam, color_lnf)),\r\n          hovertemplate = paste('Reason For Travel Detailed: %{x}<br>',\r\n                                'Total Number of Events: %{y}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Reason for Travel Detailed EDA\",\r\n         xaxis = list(title = \"\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nactivity_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b4381d1e6a\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b4381d1e6a\",\"attrs\":{\"15b4381d1e6a\":{\"x\":{},\"y\":{},\"marker\":{\"color\":[\"orchid\",\"darkorchid\",\"purple\"]},\"hovertemplate\":\"Reason For Travel Detailed: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Reason for Travel Detailed EDA\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Leisure - Non-Family\",\"Business\",\"Leisure - Family\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Leisure - Non-Family\",\"Business\",\"Leisure - Family\"],\"y\":[832499,744831,86153],\"marker\":{\"color\":[\"orchid\",\"darkorchid\",\"purple\"],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Reason For Travel Detailed: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Reason For Travel Detailed: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Reason For Travel Detailed: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\nreason_travel_data$pct_total <- prop.table(reason_travel_data$reason_travel_sum)\r\n\r\nDT::datatable(data = reason_travel_data,\r\n              options = list(pageLength = 4),\r\n              colnames = c(\"Reason for Travel Detailed\", \"Total Number of Events\", \"Percent of Total\"),\r\n              rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('reason_travel_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"Leisure - Non-Family\",\"Business\",\"Leisure - Family\"],[832499,744831,86153],[0.500455369847483,0.447753899498823,0.0517907306536947]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Reason for Travel Detailed<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":4,\"columnDefs\":[{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2]}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[4,10,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nOrigin Country Code\r\n\r\n\r\nhide\r\n\r\norigin_country_data <- raw_data %>%\r\n  group_by(origin_country_code) %>%\r\n  summarise(origin_country_sum = sum(total_number_events)) %>%\r\n  arrange(desc(origin_country_sum))\r\n\r\norigin_country_total <- origin_country_data %>%\r\n  slice_head(n = 10) %>%\r\n  plot_ly(x=~origin_country_sum,\r\n          y=~reorder(origin_country_code,origin_country_sum),\r\n          type= 'bar',\r\n          marker = list(color = color_book),\r\n          hovertemplate = paste('Origin Country: %{y}<br>',\r\n                                'Total Number of Events: %{x}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Top 10 Origin Country Code EDA\",\r\n         yaxis = list(title = \"\"),\r\n         xaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\norigin_country_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b4cd12ed0\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b4cd12ed0\",\"attrs\":{\"15b4cd12ed0\":{\"x\":{},\"y\":{},\"marker\":{\"color\":\"purple\"},\"hovertemplate\":\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Top 10 Origin Country Code EDA\",\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"CH\",\"IN\",\"NL\",\"CA\",\"IT\",\"ES\",\"US\",\"FR\",\"DE\",\"GB\"]},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[531502,380010,287305,173432,159726,88049,7426,3622,2424,2190],\"y\":[\"GB\",\"DE\",\"FR\",\"US\",\"ES\",\"IT\",\"CA\",\"NL\",\"IN\",\"CH\"],\"marker\":{\"color\":\"purple\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Origin Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\"],\"type\":\"bar\",\"orientation\":\"h\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\norigin_country_data$pct_total <- prop.table(origin_country_data$origin_country_sum)\r\n\r\nDT::datatable(data = origin_country_data,\r\n              options = list(pageLength = 20),\r\n              colnames = c(\"Origin Country Code\", \"Total Number of Events\", \"Percent of Total\"),\r\n              #rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('origin_country_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\"],[\"GB\",\"DE\",\"FR\",\"US\",\"ES\",\"IT\",\"CA\",\"NL\",\"IN\",\"CH\",\"BE\",\"IE\",null,\"VN\",\"AT\",\"RO\",\"DK\",\"PT\",\"SE\",\"PL\",\"AE\",\"RU\",\"HK\",\"MX\",\"AU\",\"IL\",\"JP\",\"DO\",\"NO\",\"GR\",\"BR\",\"TR\",\"BG\",\"SG\",\"SA\",\"HU\",\"NG\",\"CO\",\"TH\",\"CZ\",\"FI\",\"LU\",\"UA\",\"MA\",\"PK\",\"MY\",\"ZA\",\"CR\",\"EG\",\"HR\",\"KR\",\"MU\",\"EE\",\"AR\",\"DZ\",\"ID\",\"JE\",\"PE\",\"CY\",\"MT\",\"MC\",\"EC\",\"SK\",\"PH\",\"TW\",\"GP\",\"NZ\",\"GT\",\"PR\",\"RE\",\"BH\",\"QA\",\"VE\",\"RS\",\"KW\",\"AZ\",\"CN\",\"GE\",\"PA\",\"IM\",\"TN\",\"LV\",\"GH\",\"LT\",\"OM\",\"AW\",\"BY\",\"IS\",\"LB\",\"JO\",\"AD\",\"IR\",\"HN\",\"MQ\",\"SI\",\"NI\",\"UY\",\"KZ\",\"BM\",\"MD\",\"BB\",\"BD\",\"SN\",\"KE\",\"TZ\",\"AL\",\"IQ\",\"GI\",\"KY\",\"LI\",\"RW\",\"MK\",\"MV\",\"BS\",\"GG\",\"TT\",\"BA\",\"LY\",\"CD\",\"GF\",\"AM\",\"BO\",\"CL\",\"NP\",\"PF\",\"UG\",\"ZW\",\"GN\",\"SV\",\"BJ\",\"CI\",\"GA\",\"MO\",\"JM\",\"LK\",\"MG\",\"DJ\",\"SX\",\"NC\",\"SM\",\"CW\",\"KH\",\"MR\",\"BF\",\"KG\",\"ML\",\"UZ\",\"VI\",\"AF\",\"AG\",\"BN\",\"CM\",\"ME\",\"MF\",\"PW\",\"SO\",\"UM\",\"AI\",\"BZ\",\"CG\",\"ET\",\"LC\",\"PS\",\"TG\",\"YT\",\"ZM\",\"AO\",\"CV\",\"GU\",\"GY\",\"LR\",\"PM\",\"SD\",\"SR\",\"SY\",\"TJ\",\"VG\",\"YE\"],[531502,380010,287305,173432,159726,88049,7426,3622,2424,2190,1984,1536,1396,1377,1117,1116,900,899,893,803,746,693,641,620,598,585,572,550,446,437,425,413,390,303,292,290,280,273,255,242,233,233,227,225,215,203,199,181,177,165,161,158,143,141,139,131,126,123,119,116,114,113,108,92,91,90,86,85,82,81,78,76,75,70,68,67,66,66,62,60,59,58,56,55,55,54,53,53,52,51,49,48,46,37,36,34,34,32,31,31,30,29,28,27,25,24,24,23,23,20,20,19,19,18,18,18,17,17,16,16,15,15,15,15,15,15,15,14,14,13,12,11,11,9,9,9,7,7,6,6,5,5,5,4,4,4,4,4,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1],[0.319511530926376,0.228442370616351,0.172712916212549,0.1042583543084,0.0960190155234529,0.0529305078561067,0.00446412737611385,0.00217735919152766,0.00145718351194452,0.00131651480658354,0.00119267825400079,0.000923363809549,0.000839203045657816,0.000827781227701155,0.000671482666188954,0.000670881517875446,0.000541033482157617,0.000540432333844109,0.000536825443963058,0.000482722095747296,0.000448456641877314,0.000416595781261365,0.000385336068958925,0.000372711954375248,0.000359486691478061,0.000351671763402451,0.000343856835326841,0.000330631572429655,0.000268112147824775,0.000262701813003199,0.000255488033241097,0.000248274253478996,0.000234447842268301,0.000182147938993065,0.000175535307544471,0.000174333010917455,0.00016832152778237,0.000164113489587811,0.000153292819944658,0.000145477891869048,0.000140067557047472,0.000140067557047472,0.000136460667166421,0.000135258370539404,0.00012924688740432,0.000122033107642218,0.000119628514388184,0.000108807844745032,0.000106403251490998,9.91894717288965e-05,9.67848784748627e-05,9.49814335343373e-05,8.59642088317103e-05,8.47619122046934e-05,8.35596155776765e-05,7.87504290696088e-05,7.57446875020665e-05,7.39412425615411e-05,7.15366493075072e-05,6.97332043669818e-05,6.85309077399649e-05,6.79297594264564e-05,6.49240178589141e-05,5.53056448427787e-05,5.47044965292702e-05,5.41033482157617e-05,5.16987549617279e-05,5.10976066482194e-05,4.9294161707694e-05,4.86930133941856e-05,4.68895684536602e-05,4.56872718266433e-05,4.50861235131348e-05,4.20803819455925e-05,4.08780853185755e-05,4.02769370050671e-05,3.96757886915586e-05,3.96757886915586e-05,3.72711954375248e-05,3.60688988105078e-05,3.54677504969994e-05,3.48666021834909e-05,3.3664305556474e-05,3.30631572429655e-05,3.30631572429655e-05,3.2462008929457e-05,3.18608606159486e-05,3.18608606159486e-05,3.12597123024401e-05,3.06585639889317e-05,2.94562673619147e-05,2.88551190484063e-05,2.76528224213893e-05,2.22424875998132e-05,2.16413392863047e-05,2.04390426592878e-05,2.04390426592878e-05,1.92367460322708e-05,1.86355977187624e-05,1.86355977187624e-05,1.80344494052539e-05,1.74333010917455e-05,1.6832152778237e-05,1.62310044647285e-05,1.50287078377116e-05,1.44275595242031e-05,1.44275595242031e-05,1.38264112106947e-05,1.38264112106947e-05,1.20229662701693e-05,1.20229662701693e-05,1.14218179566608e-05,1.14218179566608e-05,1.08206696431524e-05,1.08206696431524e-05,1.08206696431524e-05,1.02195213296439e-05,1.02195213296439e-05,9.61837301613542e-06,9.61837301613542e-06,9.01722470262696e-06,9.01722470262696e-06,9.01722470262696e-06,9.01722470262696e-06,9.01722470262696e-06,9.01722470262696e-06,9.01722470262696e-06,8.41607638911849e-06,8.41607638911849e-06,7.81492807561003e-06,7.21377976210157e-06,6.6126314485931e-06,6.6126314485931e-06,5.41033482157618e-06,5.41033482157618e-06,5.41033482157618e-06,4.20803819455925e-06,4.20803819455925e-06,3.60688988105078e-06,3.60688988105078e-06,3.00574156754232e-06,3.00574156754232e-06,3.00574156754232e-06,2.40459325403386e-06,2.40459325403386e-06,2.40459325403386e-06,2.40459325403386e-06,2.40459325403386e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Origin Country Code<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":20,\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,20,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nHotel City\r\n\r\n\r\nhide\r\n\r\nhotel_city_data <- raw_data %>%\r\n  group_by(hotel_city) %>%\r\n  summarise(hotel_city_sum = sum(total_number_events)) %>%\r\n  arrange(desc(hotel_city_sum))\r\n\r\nhotel_city_total <- hotel_city_data %>%\r\n  slice_head(n = 10) %>%\r\n  plot_ly(x=~hotel_city_sum,\r\n          y=~reorder(hotel_city,hotel_city_sum),\r\n          type= 'bar',\r\n          marker = list(color = color_book),\r\n          hovertemplate = paste('Hotel City: %{y}<br>',\r\n                                'Total Number of Events: %{x}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Top 10 Hotel City EDA\",\r\n         yaxis = list(title = \"\"),\r\n         xaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nhotel_city_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b450977bfb\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b450977bfb\",\"attrs\":{\"15b450977bfb\":{\"x\":{},\"y\":{},\"marker\":{\"color\":\"purple\"},\"hovertemplate\":\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Top 10 Hotel City EDA\",\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"lyon\",\"rome\",\"manchester\",\"edinburgh\",\"birmingham\",\"hamburg\",\"barcelona\",\"madrid\",\"berlin\",\"london\"]},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[328957,121776,96916,90934,89939,87599,61154,61065,54223,52378],\"y\":[\"london\",\"berlin\",\"madrid\",\"barcelona\",\"hamburg\",\"birmingham\",\"edinburgh\",\"manchester\",\"rome\",\"lyon\"],\"marker\":{\"color\":\"purple\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel City: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\"],\"type\":\"bar\",\"orientation\":\"h\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\nhotel_city_data$pct_total <- prop.table(hotel_city_data$hotel_city_sum)\r\n\r\nDT::datatable(data = hotel_city_data,\r\n              options = list(pageLength = 37),\r\n              colnames = c(\"Hotel City\", \"Total Number of Events\", \"Percent of Total\"),\r\n              #rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('hotel_city_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\"],[\"london\",\"berlin\",\"madrid\",\"barcelona\",\"hamburg\",\"birmingham\",\"edinburgh\",\"manchester\",\"rome\",\"lyon\",\"munich\",\"bordeaux\",\"nice\",\"milan\",\"marseille\",\"bristol\",\"frankfurt\",\"florence\",\"liverpool\",\"koeln\",\"lille\",\"mnchen\",\"venice\",\"leeds\",\"stuttgart\",\"malaga\",\"orly\",\"hannover\",\"kln\",\"sevilla\",\"duesseldorf\",\"cologne\",\"seville\",\"palma de mallorca\",\"firenze\",\"venezia\",\"dusseldorf\"],[328957,121776,96916,90934,89939,87599,61154,61065,54223,52378,49346,44639,42955,42377,40041,36556,31752,30641,29844,25341,23950,23740,23144,22697,19178,17060,16157,15693,13632,12690,11166,10351,10201,9562,6428,5619,3782],[0.197751945766804,0.0732054370258067,0.0582608899519863,0.0546648207405787,0.0540666781686377,0.0526599911150279,0.0367626239642966,0.0367091217643943,0.0325960650033694,0.0314869463649463,0.0296642646783887,0.0268346595667043,0.0258223258067561,0.0254748620815482,0.0240705796211924,0.0219755777486154,0.0190876612505207,0.0184197854742128,0.0179406702683466,0.015233699412618,0.0143975021085277,0.0142712609626909,0.0139129765678399,0.0136442632717016,0.0115288223564653,0.0102555902284544,0.00971275330135625,0.00943382048388832,0.00819485380974738,0.00762857209842241,0.00671242206863551,0.00622248619312611,0.00613231394609984,0.00574818017376793,0.00386418135923241,0.00337785237360406,0.00227354292168901]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Hotel City<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":37,\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,25,37,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nHotel State\r\n\r\n\r\nhide\r\n\r\nhotel_state_data <- raw_data %>%\r\n  group_by(hotel_state) %>%\r\n  summarise(hotel_state_sum = sum(total_number_events)) %>%\r\n  arrange(desc(hotel_state_sum))\r\n\r\nhotel_state_total <- hotel_state_data %>%\r\n  slice_head(n = 10) %>%\r\n  plot_ly(x=~hotel_state_sum,\r\n          y=~reorder(hotel_state,hotel_state_sum),\r\n          type= 'bar',\r\n          marker = list(color = color_book),\r\n          hovertemplate = paste('Hotel State: %{y}<br>',\r\n                                'Total Number of Events: %{x}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Top 10 Hotel State EDA\",\r\n         yaxis = list(title = \"\"),\r\n         xaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nhotel_state_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b46c7d1e6a\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b46c7d1e6a\",\"attrs\":{\"15b46c7d1e6a\":{\"x\":{},\"y\":{},\"marker\":{\"color\":\"purple\"},\"hovertemplate\":\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Top 10 Hotel State EDA\",\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"tn\",\"va\",\"fl\",\"on\",\"nh\",\"ky\",\"sc\",\"ct\",\"al\"]},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[46419,12961,10448,6647,4520,4068,3700,3018,2472],\"y\":[\"al\",\"ct\",\"sc\",\"ky\",\"nh\",\"on\",\"fl\",\"va\",\"tn\"],\"marker\":{\"color\":\"purple\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel State: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\"],\"type\":\"bar\",\"orientation\":\"h\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\nhotel_state_data$pct_total <- prop.table(hotel_state_data$hotel_state_sum)\r\n\r\nDT::datatable(data = hotel_state_data,\r\n              options = list(pageLength = 20),\r\n              colnames = c(\"Hotel State\", \"Total Number of Events\", \"Percent of Total\"),\r\n              #rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('hotel_state_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\"],[null,\"al\",\"ct\",\"sc\",\"ky\",\"nh\",\"on\",\"fl\",\"va\",\"tn\",\"provence-alpes-cte d'azur\",\"ny\",\"ga\",\"oh\",\"vt\",\"angleterre\",\"inglaterra\",\"auvergne-rhne-alpes\",\"latium\",\"or\",\"inghilterra\",\"in\",\"pa\",\"autonome gemeinschaft madrid\",\"lacio\",\"bayern\",\"lombardei\",\"ar\",\"fi\",\"baden-wrttemberg\",\"mi\",\"nordrhein-westfalen\",\"niedersachsen\",\"hamburg\",\"schottland\",\"lombardie\",\"communaut de madrid\",\"md\",\"ara\",\"toscane\",\"en\",\"ns\",\"metropolitan city of rome\",\"nj\",\"firenze\",\"ia\",\"hesse\",\"metropolitan city of venice\",\"co\",\"provenza-alpi-costa azzurra\",\"ri\",\"le-de-france\",\"auvernia-rdano-alpes\",\"ca\",\"rm\",\"provence-alpes-cte d''azur\",\"az\",\"il\",\"metropolitan city of florence\",\"provenza-alpes-costa azul\",\"florence\",\"mo\",\"vt 05255\",\"florenz\",\"tx\",\"provence-alpes-cte d''''azur\",\"catalunya\",\"ms\",\"andalusia\",\"hannover\",\"wi\",\"edh\",\"los angeles\",\"34\",\"lcio\",\"me\",\"metropolitan city of milan\",\"ni\",\"pa 19007\",\"ve\",\"england\",\"la\",\"liv\",\"nh 03103\",\"pac\",\"sc 29501\",\"35208\",\"al 35204\",\"al 35226\",\"al 35242\",\"barcelona\",\"berlim\",\"eye\",\"fla\",\"ib\",\"ma\",\"nuova aquitania\",\"ny 14075\",\"provence-alpes-cote d'azur\",\"seedorf\",\"11\",\"35242\",\"al 35203\",\"al 35205\",\"al 35215\",\"auvergne-rhone-alpes\",\"bavire\",\"birmingham\",\"ca 95459\",\"city\",\"city of edinburgh\",\"ct 06042\",\"de\",\"district\",\"ga 30165\",\"isla de francia\",\"kln\",\"ks\",\"ky 40744\",\"ma 01062\",\"md 21811\",\"mn\",\"mo 63341\",\"nd\",\"ne\",\"nh 03101\",\"nh 03104\",\"nh 03109\",\"nj 08009\",\"nm\",\"oh 44889\",\"on n6e 3z7\",\"prat\",\"provence-alpes-cte d''''''''''''''''''''''''''''''''azur\",\"provence-alpes-cte d''''''''''''''''azur\",\"provence-alpes-cte d''''''''azur\",\"qc\",\"renault\",\"roma\",\"tn 37355\",\"tn 37620\",\"ut\",\"va 24202\",\"venise\",\"vic\"],[1553111,46419,12961,10448,6647,4520,4068,3700,3018,2472,2036,1703,1666,1413,1056,714,704,619,546,511,424,364,341,278,266,257,254,252,231,230,203,168,135,131,128,121,118,105,95,85,77,55,51,51,50,45,44,44,40,33,33,27,25,25,25,23,22,20,20,17,14,12,12,11,11,10,9,9,8,7,6,5,5,4,4,4,4,4,4,4,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0.933650058341444,0.0279047035647494,0.0077914832913832,0.00628079757953643,0.00399583283989076,0.00271719037705826,0.00244547133935243,0.00222424875998132,0.00181426561016854,0.00148603863099292,0.00122393796630323,0.00102375557790491,0.0010015130903051,0.000849422566987459,0.000634812619064938,0.000429219895845043,0.000423208412709959,0.000372110806061739,0.000328226979175621,0.000307186788202825,0.000254886884927589,0.000218817986117081,0.000204991574906386,0.000167119231155353,0.000159905451393251,0.000154495116571675,0.00015269167163115,0.000151489375004133,0.000138865260420455,0.000138264112106947,0.000122033107642218,0.000100992916669422,8.11550223236426e-05,7.87504290696088e-05,7.69469841290834e-05,7.27389459345241e-05,7.09355009939987e-05,6.31205729183887e-05,5.71090897833041e-05,5.10976066482194e-05,4.62884201401517e-05,3.30631572429655e-05,3.06585639889317e-05,3.06585639889317e-05,3.00574156754232e-05,2.70516741078809e-05,2.64505257943724e-05,2.64505257943724e-05,2.40459325403386e-05,1.98378943457793e-05,1.98378943457793e-05,1.62310044647285e-05,1.50287078377116e-05,1.50287078377116e-05,1.50287078377116e-05,1.38264112106947e-05,1.32252628971862e-05,1.20229662701693e-05,1.20229662701693e-05,1.02195213296439e-05,8.41607638911849e-06,7.21377976210157e-06,7.21377976210157e-06,6.6126314485931e-06,6.6126314485931e-06,6.01148313508464e-06,5.41033482157618e-06,5.41033482157618e-06,4.80918650806771e-06,4.20803819455925e-06,3.60688988105078e-06,3.00574156754232e-06,3.00574156754232e-06,2.40459325403386e-06,2.40459325403386e-06,2.40459325403386e-06,2.40459325403386e-06,2.40459325403386e-06,2.40459325403386e-06,2.40459325403386e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.80344494052539e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Hotel State<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":20,\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,20,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nHotel Country\r\n\r\n\r\nhide\r\n\r\nhotel_country_data <- raw_data %>%\r\n  group_by(hotel_country) %>%\r\n  summarise(hotel_country_sum = sum(total_number_events)) %>%\r\n  arrange(desc(hotel_country_sum))\r\n\r\nhotel_country_total <- hotel_country_data %>%\r\n  slice_head(n = 10) %>%\r\n  plot_ly(x=~hotel_country_sum,\r\n          y=~reorder(hotel_country,hotel_country_sum),\r\n          type= 'bar',\r\n          marker = list(color = color_book),\r\n          hovertemplate = paste('Hotel Country: %{y}<br>',\r\n                                'Total Number of Events: %{x}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Top 10 Hotel Country EDA\",\r\n         yaxis = list(title = \"\"),\r\n         xaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nhotel_country_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b4d9d33e1\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b4d9d33e1\",\"attrs\":{\"15b4d9d33e1\":{\"x\":{},\"y\":{},\"marker\":{\"color\":\"purple\"},\"hovertemplate\":\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Top 10 Hotel Country EDA\",\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"au\",\"espaa\",\"ca\",\"us\",\"it\",\"fr\",\"es\",\"de\",\"gb\"]},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[561605,412090,233710,220140,132562,84435,4490,48,22],\"y\":[\"gb\",\"de\",\"es\",\"fr\",\"it\",\"us\",\"ca\",\"espaa\",\"au\"],\"marker\":{\"color\":\"purple\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\",\"Hotel Country: %{y}<br> Total Number of Events: %{x} <extra><\\/extra>\"],\"type\":\"bar\",\"orientation\":\"h\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\nhotel_country_data$pct_total <- prop.table(hotel_country_data$hotel_country_sum)\r\n\r\nDT::datatable(data = hotel_country_data,\r\n              options = list(pageLength = 20),\r\n              colnames = c(\"Hotel Country\", \"Total Number of Events\", \"Percent of Total\"),\r\n              #rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('hotel_country_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\"],[\"gb\",\"de\",\"es\",\"fr\",\"it\",\"us\",null,\"ca\",\"espaa\",\"au\",\"on\",\"ru\",\"(not set)\",\"catalunya\",\"gran bretaa\",\"sct\",\"jp\",\"co\",\"germania\",\"gran bretagna\",\"ns\",\"regno unito\",\"alemania\",\"allemagne\",\"br\",\"grande bretagne\",\"grobritannien\",\"reino unido\",\"royaume-uni\"],[561605,412090,233710,220140,132562,84435,14304,4490,48,22,18,12,10,7,5,5,3,2,2,2,2,2,1,1,1,1,1,1,1],[0.337607898607921,0.247727208513703,0.140494372350063,0.132336789735753,0.079689422735309,0.0507579578510871,0.00859882547642507,0.002699155927653,2.88551190484063e-05,1.32252628971862e-05,1.08206696431524e-05,7.21377976210157e-06,6.01148313508464e-06,4.20803819455925e-06,3.00574156754232e-06,3.00574156754232e-06,1.80344494052539e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,1.20229662701693e-06,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07,6.01148313508464e-07]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Hotel Country<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":20,\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,20,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nTraveler Value Group EDA\r\n\r\n\r\nhide\r\n\r\ncolor_low <- \"orchid\" #business\r\ncolor_med <- \"darkorchid\"  #leisure-family\r\ncolor_high  <- \"purple\"  #leisure-non-family\r\n\r\ntraveler_value_data <- raw_data %>%\r\n  group_by(traveler_value_group) %>%\r\n  summarise(traveler_value_sum = sum(total_number_events))%>%\r\n  arrange(desc(traveler_value_sum))\r\n\r\ntraveler_value_total <- traveler_value_data %>%\r\n  plot_ly(x=~reorder(traveler_value_group,desc(traveler_value_sum)),\r\n          y=~traveler_value_sum,\r\n          type= 'bar',\r\n          marker = list(color = c(color_low,color_med, color_high)),\r\n          hovertemplate = paste('Traveler Value Group: %{x}<br>',\r\n                                'Total Number of Events: %{y}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Traveler Value Group EDA\",\r\n         xaxis = list(title = \"\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\ntraveler_value_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b45f663e72\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b45f663e72\",\"attrs\":{\"15b45f663e72\":{\"x\":{},\"y\":{},\"marker\":{\"color\":[\"orchid\",\"darkorchid\",\"purple\"]},\"hovertemplate\":\"Traveler Value Group: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Traveler Value Group EDA\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Low\",\"Med\",\"High\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Low\",\"Med\",\"High\"],\"y\":[980449,514428,167925],\"marker\":{\"color\":[\"orchid\",\"darkorchid\",\"purple\"],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Traveler Value Group: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Traveler Value Group: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Traveler Value Group: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\ntraveler_value_data$pct_total <- prop.table(traveler_value_data$traveler_value_sum)\r\n\r\nDT::datatable(data = traveler_value_data,\r\n              options = list(pageLength = 4),\r\n              colnames = c(\"Traveler Value Group\", \"Total Number of Events\", \"Percent of Total\"),\r\n              rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('traveler_value_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"Low\",\"Med\",\"High\",null],[980449,514428,167925,681],[0.58939526283106,0.309247524621532,0.100947830545909,0.000409382001499264]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Traveler Value Group<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":4,\"columnDefs\":[{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2]}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[4,10,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nCheckin Year EDA\r\n\r\n\r\nhide\r\n\r\ncheckin_year_data <- raw_data %>%\r\n  group_by(checkin_year) %>%\r\n  summarise(checkin_year_sum = sum(total_number_events))\r\n\r\ncheckin_year_total <- checkin_year_data %>%\r\n  plot_ly(x=~checkin_year,\r\n          y=~checkin_year_sum,\r\n          type= 'bar',\r\n          marker = list(color = c(color_2019,color_low, color_2021, color_low, color_low, color_low)),\r\n          hovertemplate = paste('Checkin Year: %{x}<br>',\r\n                                'Total Number of Events: %{y}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Checkin Year EDA\",\r\n         xaxis = list(title = \"\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\ncheckin_year_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b41f831bb\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b41f831bb\",\"attrs\":{\"15b41f831bb\":{\"x\":{},\"y\":{},\"marker\":{\"color\":[\"darkgray\",\"orchid\",\"purple\",\"orchid\",\"orchid\",\"orchid\"]},\"hovertemplate\":\"Checkin Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Checkin Year EDA\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"2019\",\"2020\",\"2021\",\"2022\",\"2023\",\"2032\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"2019\",\"2020\",\"2021\",\"2022\",\"2023\",\"2032\"],\"y\":[1283930,2172,376074,1305,1,1],\"marker\":{\"color\":[\"darkgray\",\"orchid\",\"purple\",\"orchid\",\"orchid\",\"orchid\"],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Checkin Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Year: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\ncheckin_year_data$pct_total <- prop.table(checkin_year_data$checkin_year_sum) \r\n\r\nDT::datatable(data = checkin_year_data,\r\n              options = list(pageLength = 10),\r\n              colnames = c(\"Checkin Year\", \"Total Number of Events\", \"Percent of Total\"),\r\n              rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('checkin_year_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"2019\",\"2020\",\"2021\",\"2022\",\"2023\",\"2032\"],[1283930,2172,376074,1305,1,1],[0.771832354162922,0.00130569413694038,0.226076250854382,0.000784498549128545,6.01148313508464e-07,6.01148313508464e-07]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Checkin Year<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2]}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nCheckin Month Day EDA\r\n\r\n\r\nhide\r\n\r\ncheckin_month_data <- raw_data %>%\r\n  group_by(checkin_month) %>%\r\n  summarise(checkin_month_sum = sum(total_number_events)) \r\n\r\nevent_month_total <- checkin_month_data %>%\r\n  plot_ly(x=~checkin_month,\r\n          y=~checkin_month_sum,\r\n          type= 'bar',\r\n          marker = list(color = color_2021),\r\n          hovertemplate = paste('Checkin Month: %{x}<br>',\r\n                                'Total Number of Events: %{y}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Checkin Month EDA\",\r\n         xaxis = list(title = \"\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\nevent_month_total\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b477a02f71\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b477a02f71\",\"attrs\":{\"15b477a02f71\":{\"x\":{},\"y\":{},\"marker\":{\"color\":\"purple\"},\"hovertemplate\":\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Checkin Month EDA\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\"},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"y\":[576590,397530,198428,137436,101044,70840,53063,42872,33631,22615,12699,16735],\"marker\":{\"color\":\"purple\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\",\"Checkin Month: %{x}<br> Total Number of Events: %{y} <extra><\\/extra>\"],\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\ncheckin_month_data$pct_total <- prop.table(checkin_month_data$checkin_month_sum) \r\n\r\nDT::datatable(data = checkin_month_data,\r\n              options = list(pageLength = 12),\r\n              colnames = c(\"Checkin Month\", \"Total Number of Events\", \"Percent of Total\"),\r\n              rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('checkin_month_sum', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],[576590,397530,198428,137436,101044,70840,53063,42872,33631,22615,12699,16735],[0.346616106085845,0.23897448906902,0.119284657552857,0.0826194196153492,0.0607424301901492,0.0425853465289396,0.0318987329596996,0.0257724304967349,0.0202172189316031,0.0135949691099939,0.00763398243324398,0.0100602170265641]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Checkin Month<\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":12,\"columnDefs\":[{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2]}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,12,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\nTotal Number of Events Histogram\r\n\r\n\r\nhide\r\n\r\ntotal_event_data <- raw_data %>%\r\n  count(total_number_events) %>%\r\n  rename(count = n) %>%\r\n  arrange(desc(count))\r\n\r\ntotal_event_hist <- total_event_data %>%\r\n  slice_head(n = 10) %>%\r\n  plot_ly(x=~count,\r\n          y=~reorder(total_number_events,count),\r\n          type= 'bar',\r\n          marker = list(color = color_2021),\r\n          hovertemplate = paste('Total Number of Events: %{y} <br>',\r\n                                'Count: %{x}',\r\n                                '<extra><\/extra>')) %>%\r\n  layout(title = \"Top 10 Total Number of Events Histogram\",\r\n         xaxis = list(title = \"Count\"),\r\n         yaxis = list(title = \"Total Number of Events\"),\r\n         hoverlabel=list(bgcolor=color_bg))\r\n\r\ntotal_event_hist\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"15b463bd6bc9\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"15b463bd6bc9\",\"attrs\":{\"15b463bd6bc9\":{\"x\":{},\"y\":{},\"marker\":{\"color\":\"purple\"},\"hovertemplate\":\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Top 10 Total Number of Events Histogram\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Count\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Total Number of Events\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"10\",\"9\",\"8\",\"7\",\"6\",\"5\",\"4\",\"3\",\"2\",\"1\"]},\"hoverlabel\":{\"bgcolor\":\"snow\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[446237,133479,53021,28056,16494,10666,7263,5303,3906,3121],\"y\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],\"marker\":{\"color\":\"purple\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"hovertemplate\":[\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\",\"Total Number of Events: %{y} <br> Count: %{x} <extra><\\/extra>\"],\"type\":\"bar\",\"orientation\":\"h\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\nhide\r\n\r\ntotal_event_data$pct_total <- prop.table(total_event_data$count)\r\n\r\nDT::datatable(data = total_event_data,\r\n              options = list(pageLength = 20),\r\n              colnames = c(\"Total Number of Events\", \"Count\", \"Percent of Total\"),\r\n              #rownames = FALSE,\r\n              filter = \"none\",\r\n              autoHideNavigation = TRUE) %>%\r\n  formatRound('count', digits = 0) %>%\r\n  formatPercentage('pct_total', 2)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"vertical\":false,\"autoHideNavigation\":true,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,33,32,35,34,36,38,37,41,39,42,40,43,47,44,45,46,53,50,51,48,49,52,58,59,55,54,56,60,61,63,72,62,65,70,57,67,73,75,71,74,93,64,68,69,76,77,84,66,82,83,91,89,88,97,101,81,86,87,98,103,78,79,80,85,95,104,92,105,94,110,120,121,90,96,107,111,114,117,118,119,122,127,132,348,99,106,109,112,113,115,116,124,125,133,136,138,140,143,146,165,183,241,251,256,263,291,100,102,108,123,128,130,141,142,145,147,150,153,163,164,173,174,179,180,184,185,186,187,188,202,210,214,223,226,236,237,252,253,258,262,264,265,266,268,270,271,274,276,279,283,288,289,299,314,321,327,330,338,354,357,370,390],[446237,133479,53021,28056,16494,10666,7263,5303,3906,3121,2477,1955,1670,1283,1139,904,801,685,575,521,444,384,368,343,268,231,227,202,183,173,140,136,126,111,106,103,82,81,75,73,70,65,62,58,55,53,46,42,41,38,36,32,32,32,29,28,27,27,25,19,18,17,16,16,16,15,15,15,15,14,14,14,13,13,13,12,12,12,10,10,10,10,9,8,8,8,7,7,7,7,7,6,6,6,6,6,6,5,5,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0.615673397305445,0.184161038638512,0.0731530984623238,0.0387088763029546,0.0227567795031699,0.0147158851813271,0.0100207644920288,0.00731655157665271,0.00538911002421374,0.00430604515759629,0.00341751805682986,0.00269731441304093,0.00230409977993778,0.0017701556991977,0.00157147883194558,0.00124724922219386,0.00110514007408992,0.000945094819914597,0.00079332776854145,0.000718823943321905,0.000612587007360702,0.000529804979338985,0.000507729771866528,0.000473237260190813,0.000369759725163667,0.000318710807883608,0.000313192006015494,0.000278699494339779,0.000252485185466235,0.000238688180795949,0.000193158065384005,0.000187639263515891,0.000173842258845605,0.000153146751840175,0.000146248249505032,0.000142109148103947,0.000113135438296346,0.000111755737829317,0.000103477535027146,0.000100718134093088,9.65790326920026e-05,8.96805303568595e-05,8.55414289557737e-05,8.00226270876593e-05,7.58835256865734e-05,7.31241247525162e-05,6.3466221483316e-05,5.79474196152015e-05,5.65677191481729e-05,5.24286177470871e-05,4.96692168130299e-05,4.41504149449155e-05,4.41504149449155e-05,4.41504149449155e-05,4.00113135438296e-05,3.8631613076801e-05,3.72519126097724e-05,3.72519126097724e-05,3.44925116757152e-05,2.62143088735436e-05,2.48346084065149e-05,2.34549079394863e-05,2.20752074724577e-05,2.20752074724577e-05,2.20752074724577e-05,2.06955070054291e-05,2.06955070054291e-05,2.06955070054291e-05,2.06955070054291e-05,1.93158065384005e-05,1.93158065384005e-05,1.93158065384005e-05,1.79361060713719e-05,1.79361060713719e-05,1.79361060713719e-05,1.65564056043433e-05,1.65564056043433e-05,1.65564056043433e-05,1.37970046702861e-05,1.37970046702861e-05,1.37970046702861e-05,1.37970046702861e-05,1.24173042032575e-05,1.10376037362289e-05,1.10376037362289e-05,1.10376037362289e-05,9.65790326920026e-06,9.65790326920026e-06,9.65790326920026e-06,9.65790326920026e-06,9.65790326920026e-06,8.27820280217165e-06,8.27820280217165e-06,8.27820280217165e-06,8.27820280217165e-06,8.27820280217165e-06,8.27820280217165e-06,6.89850233514304e-06,6.89850233514304e-06,5.51880186811443e-06,5.51880186811443e-06,5.51880186811443e-06,5.51880186811443e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,4.13910140108582e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,2.75940093405722e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06,1.37970046702861e-06]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Total Number of Events<\\/th>\\n      <th>Count<\\/th>\\n      <th>Percent of Total<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":20,\"columnDefs\":[{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatPercentage(data, 2, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 0, 3, \\\",\\\", \\\".\\\");\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2,3]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,20,25,50,100]}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\"],\"jsHooks\":[]}\r\n2.2 Data Preparation\r\nDistill is a publication format for scientific and technical writing, native to the web.\r\n2.3 Data Visualisation\r\nDistill is a publication format for scientific and technical writing, native to the web.\r\n3. Derived Insights\r\nDistill is a publication format for scientific and technical writing, native to the web.\r\n4. Recommendations\r\nDistill is a publication format for scientific and technical writing, native to the web.\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-09-11-adara-challenge-analysis/img/preview_image.png",
    "last_modified": "2021-09-16T01:13:43+08:00",
    "input_file": "adara-challenge-analysis.knit.md",
    "preview_width": 800,
    "preview_height": 494
  }
]
